---
title: "Determinants of borehole' functionality in Northen Malawi"
author:
  - name: "Mabvuto Yesaya"
    orcid: "0000-0003-3234-9699"
    affiliation: "Malawi University of Business and Applied Sciences, Malawi"
    authornote: "ORCID: 0000-0003-3234-9699"
date: "2024-02-10"
bibliography: "../references.bib"
toc: true
format: html
code-fold: true
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r,echo=FALSE, results='hide'}
#| echo: false

# library
#data wrangling, tidying,column mutations etc
library(tidyverse)

#clean column names
library (janitor)

#for EDA
library(explore)

#here here package
library(here)

#making simple tables
library(knitr)

library(dplyr)

#for making dummy variables
library(fastDummies)

library(ggplot2)
library(unhcrthemes)
library(dplyr)
library(tidyr)
library(scales)

library(treemapify)

library(treemap)
```

```{r}
#| echo: false
#load data

borehole_data <- read_csv(here::here ("data/processed", "borehole_malawi_small.csv"))
```

# Introduction

As the case with least developed countries in the global south, Malawi relies on Hand-pumped borehole water for drinking and serves more than 20% of the population (ref-grimason) . Studies have found that a significant number of boreholes in Malawi contain elevated levels of contaminants such as fluoride, nitrate, iron, and chlorides, which may exceed the safe limits for drinking water set by the World Health Organization (ref-chimpamba).  

A study was done in TA Wasambo in Karonga district (Northern Malawi) in 2023 on handpump borehole functionality.  Although the donor community keep funding these sources of water, (ref-ward) noted that there are issues with the sustainability of the projects. Therefore, the capstone project aims to explore factors that affect borehole sustainability.  

# Methods

The data were collected in Karonga district in TA Wasambo. Two (2) trained enumerators administered 20-minute questionnaires installed on koboTooolbox to collect the borehole functionality data from 300 respondents aged 18 and above. Questions included the borehole maintainance contributions from the community, the availability of borehole spare parts, and borehole management.

The study employed a stratified random sampling technique where 29 villages were purposively sampled based on the availability of boreholes. Then, households from each village were randomly sampled based on Probability Proportional to Size (PPS)[^1], where the sample sizes varied across clusters.

[^1]: A sampling method where the probability of selecting a unit from the population is directly proportional to its size or measure of importance

## **Objectives**

1.  To know the users of boreholes per village.

2.  To check if there is a relationship between the costs that were considered before setting the tariff and the amount that is agreed to be paid as a tariff per month now

3.  To check if the actual tariff collected per month, tariff collection frequency, distance to where borehole spare parts are, presence of a service provider, actual tariff collected and conducting preventive maintenance lead to the functionality of boreholes

# Results

```{r}

#|code_folding: show

# a dataset for a plot
borehole_user <- borehole_data %>%
  group_by(village_name) %>%
  summarise(bh_use_num = sum(bh_use_num, na.rm = TRUE))
```

```{r}
ggplot(borehole_user) +
  geom_col(aes(
    x = bh_use_num,
    y = reorder(village_name, bh_use_num)
  ),
  fill = unhcr_pal(n = 1, "pal_blue"),
  width = 0.8
  ) +
  geom_text(aes(
    x = bh_use_num,
    y = reorder(village_name, bh_use_num),
    label = round(bh_use_num)
  ),
  hjust = -0.5,
  size = 8 / .pt
  ) +
  labs(
    title = "Number of households that use boreholes per village",
    
  ) +
  scale_x_continuous(expand = expansion(c(0, 0.1))) +
  theme_unhcr(
    grid = FALSE,
    axis = "y",
    axis_title = FALSE,
    axis_text = "y"
  )
```

\

```{r}
scatter <- borehole_data %>%
  filter(tariff_amount!=0 & total_money!=0) |> 
  select(tariff_costs_consider,tariff_amount)
```

```{r}
#households vs amount

ggplot(scatter,aes(x=tariff_costs_consider, y=tariff_amount,fill=tariff_costs_consider))+
  geom_violin()+
  theme(legend.position = "None")+
  labs(
    title="Distribution of the collected user tariff fee across different reasons of setting them",
    x="Basis for setting a tariff system",
    y="Amount of tariff per month (MWK)"
  )+
   theme(plot.title = element_text(size = 16),
        axis.title.x = element_text(size = 13),
        axis.title.y = element_text(size = 13),
        axis.text.x = element_text(size = 13),
        axis.text.y = element_text(size = 13)) 
```

```{r}
library(stargazer)

#small dataset for ols
ols <- borehole_data |> 
  select(available_service_provider:tarrif_frequency_when_required_for_repairs)


mod=lm(bh_functional~ .,data = ols)

stargazer(mod,type = "text",report=("vc*p"),model.names = TRUE)

```

# Conclusions

# References

```{r}

```
